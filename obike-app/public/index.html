<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>O-Bike</title>

    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="stylesheet" href="/global.css" />
    <link rel="stylesheet" href="/build/bundle.css" />

    <script
      src="https://unpkg.com/obniz@3.x/obniz.js"
      crossorigin="anonymous"
    ></script>

    <script defer src="/build/bundle.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
  </head>

  <body>
  <script>
    const obniz_id = 'obniz-id'
    const obniz = new Obniz(obniz_id);
    let speed = 0;
    let cadence = 0;

    //during obniz connection
    obniz.onconnect = async () => {
      console.log('hogehoge')
      obniz.io4?.drive('5v')
      obniz.io4?.output(true)
      obniz.io2?.output(false)
      obniz.io1?.output(false)
      obniz.ad0?.start(num => {
        if(num < 2) {
          cadence += 1
        }
      })
    };

    setInterval(() => {
      speed = cadence / 3
      console.log(speed)
      cadence = 0
    }, 3000)

  </script>
  </body>
</html>
